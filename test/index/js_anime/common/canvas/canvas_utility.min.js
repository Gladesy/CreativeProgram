function RandI2(t,e){return Math.floor(RandF2(t,e+.9999))}function RandF2(t,e){var s=t+Math.random()*(e-t);return Clamp(s,t,e)}function Lerp(t,e,s){return(e-t)*s+t}function Linear(t,e,s,i,n){return(n-t)/(e-t)*(i-s)+s}function Clamp(t,e,s){return e>t?e:s<t?s:t}function GetOs(){var t=navigator.userAgent;return t.indexOf("iPhone;")!=-1?OS_IPHONE:t.indexOf("iPod;")!=-1?OS_IPOD:t.indexOf("iPad;")!=-1?OS_IPAD:t.indexOf("Android")!=-1?OS_ANDROID:OS_UNKNOWN}function GetOsName(){switch(GetOs()){case OS_IPHONE:return"iPhone";case OS_IPOD:return"iPod";case OS_IPAD:return"iPad";case OS_ANDROID:return"Android"}return"Unknown"}function IsSmartPhone(){return null===window.ontouchstart}function OutputLog(t){"undefined"!=typeof _OutputLog&&_OutputLog.apply(this,arguments)}function Print(t,e,s){if(!(g_PrintArray.length>30)){void 0!=e&&void 0!=s||(e=2,s=10+12*(g_PrintArray.length+1));var i={Text:t,x:e,y:s};g_PrintArray.push(i)}}function BeginPrint(){g_PrintArray.length=0}var OS_UNKNOWN=0,OS_IPHONE=10,OS_IPOD=11,OS_IPAD=12,OS_ANDROID=20,g_PrintArray=new Array,M00=0,M01=2,M02=4,M10=1,M11=3,M12=5,Matrix=function(){function t(){this.M00=1,this.M10=0,this.M01=0,this.M11=1,this.M02=0,this.M12=0}return t.prototype.Set=function(t,e,s,i,n,r){this.M00=t,this.M10=e,this.M01=s,this.M11=i,this.M02=n,this.M12=r},t.prototype.Copy=function(t){this.M00=t.M00,this.M10=t.M10,this.M01=t.M01,this.M11=t.M11,this.M02=t.M02,this.M12=t.M12},t.prototype.Zero=function(){this.M00=0,this.M10=0,this.M01=0,this.M11=0,this.M02=0,this.M12=0},t.prototype.Identity=function(){this.M00=1,this.M10=0,this.M01=0,this.M11=1,this.M02=0,this.M12=0},t.prototype.SetTranslate=function(t,e){this.M00=1,this.M10=0,this.M01=0,this.M11=1,this.M02=t,this.M12=e},t.prototype.SetScale=function(t,e){this.M00=t,this.M10=0,this.M01=0,this.M11=e,this.M02=0,this.M12=0},t.prototype.SetRotate=function(t){var e=Math.PI*t/180,s=Math.cos(e),i=Math.sin(e);this.M00=s,this.M10=i,this.M01=-i,this.M11=s,this.M02=0,this.M12=0},t.prototype.SetSRT=function(t,e,s,i,n){if(0==s)this.M00=t,this.M10=0,this.M01=0,this.M11=e,this.M02=i,this.M12=n;else{var r=Math.PI*s/180,o=Math.cos(r),h=Math.sin(r);this.M00=t*o,this.M10=t*h,this.M01=-e*h,this.M11=e*o,this.M02=i,this.M12=n}},t.prototype.Mult2=function(t,e,s,i,n,r,o,h,a,u,_,l){this.Set(t*o+e*a,t*h+e*u,s*o+i*a,s*h+i*u,n*o+r*a+_,n*h+r*u+l)},t.prototype.Mult=function(t,e){this.Set(t.M00*e.M00+t.M10*e.M01,t.M00*e.M10+t.M10*e.M11,t.M01*e.M00+t.M11*e.M01,t.M01*e.M10+t.M11*e.M11,t.M02*e.M00+t.M12*e.M01+e.M02,t.M02*e.M10+t.M12*e.M11+e.M12)},t}(),PointingDevice=function(){function t(){this.m_state=e,this.m_LawX=0,this.m_LawY=0,this.m_LawIsPress=!1,this.m_LawIsTrigger=!1,this.m_LawIsRelease=!1,this.m_X=0,this.m_Y=0,this.m_IsTrigger=!1,this.m_IsPress=!1,this.m_IsRelease=!1,this.m_PressX=-1,this.m_PressY=-1,this.m_ReleaseX=-1,this.m_ReleaseY=-1,this.m_TriggerBeginTime=0,this.m_PressTime=0,this.m_IsAllowScroll=!1,this.m_AllowScrollX=0,this.m_AllowScrollY=0,this.m_AllowScrollWidth=0,this.m_AllowScrollHeight=0}var e=-1,s=0,i=1,n=2,r=3;return t.prototype.Init=function(t){function e(t){m.SetMouseState(s,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function o(t){m.SetMouseState(i,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function h(t){m.SetMouseState(n,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function a(t){m.SetMouseState(r,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function u(t){m.SetTouchState(s,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function _(t){m.SetTouchState(i,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function l(t){m.SetTouchState(n,t),CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}function c(t){CANVAS_SETTING_IGNORE_SCROLL&&0==m.IsScrollRange()&&t.preventDefault()}var m=this,S=GetOs();S!=OS_IPHONE&&S!=OS_IPOD&&S!=OS_IPAD&&(t.addEventListener("mousemove",e,!1),t.addEventListener("mousedown",o,!1),t.addEventListener("mouseup",h,!1),t.addEventListener("mouseout",a,!1)),t.addEventListener("touchmove",u,!1),t.addEventListener("touchstart",_,!1),t.addEventListener("touchend",l,!1),t.addEventListener("touchcancel",c,!1)},t.prototype.SetState=function(t,e,o){if(t==s||this.m_state!=t){switch(this.m_LawX=e,this.m_LawY=o,t){case s:break;case i:this.m_LawIsTrigger=!0,this.m_LawIsPress=!0,this.m_LawIsRelease=!1,this.m_PressX=e,this.m_PressY=o,this.m_ReleaseX=-1,this.m_ReleaseY=-1;break;case n:case r:this.m_LawIsPress&&(this.m_LawIsPress=!1,this.m_LawIsRelease=!0,this.m_ReleaseX=e,this.m_ReleaseY=o)}this.m_state=t}},t.prototype.SetMouseState=function(t,e){var s=e.target.getBoundingClientRect();this.SetState(t,e.clientX-s.left*g_canvasScale,e.clientY-s.top*g_canvasScale)},t.prototype.SetTouchState=function(t,e){if(!(e.touches.length>1))if(t==n)this.SetState(t,this.m_LawX,this.m_LawY);else{var s=e.currentTarget.getBoundingClientRect();this.SetState(t,e.touches[0].pageX-s.left*g_canvasScale-window.scrollX,e.touches[0].pageY-s.top*g_canvasScale-window.scrollY)}},t.prototype.Begin=function(t){this.m_X=this.m_LawX,this.m_Y=this.m_LawY,this.m_IsPress=this.m_LawIsPress,this.m_IsTrigger=this.m_LawIsTrigger,this.m_IsRelease=this.m_LawIsRelease,this.m_IsTrigger&&(this.m_TriggerBeginTime=t),this.m_IsPress&&(this.m_PressTime=t-this.m_TriggerBeginTime),this.m_LawIsTrigger=!1,this.m_LawIsRelease=!1},t.prototype.AllowScrollRange=function(t,e,s,i){this.m_IsAllowScroll=!0,this.m_AllowScrollX=t,this.m_AllowScrollY=e,this.m_AllowScrollWidth=s,this.m_AllowScrollHeight=i},t.prototype.IsScrollRange=function(){return 0!=this.m_IsAllowScroll&&(this.m_X>=this.m_AllowScrollX&&this.m_X<=this.m_AllowScrollX+this.m_AllowScrollWidth&&this.m_Y>=this.m_AllowScrollY&&this.m_Y<=this.m_AllowScrollY+this.m_AllowScrollHeight)},t.prototype.End=function(){this.m_IsTrigger=!1},t.prototype.GetX=function(){return this.m_X},t.prototype.GetY=function(){return this.m_Y},t.prototype.IsPress=function(){return this.m_IsPress},t.prototype.IsTrigger=function(){return this.m_IsTrigger},t.prototype.IsRelease=function(){return this.m_IsRelease},t.prototype.GetPressX=function(){return this.m_PressX},t.prototype.GetPressY=function(){return this.m_PressY},t.prototype.GetReleaseX=function(){return this.m_ReleaseX},t.prototype.GetReleaseY=function(){return this.m_ReleaseY},t.prototype.GetPressTime=function(){return this.m_PressTime/1e3},t}(),EntityManager=function(){function t(){this.m_EntityArray=new Array}return t.prototype.Create=function(t){var e=new t;return this.m_EntityArray.push(e),e},t.prototype.Remove=function(t){for(var e in this.m_EntityArray)if(this.m_EntityArray[e]==t)return void this.m_EntityArray.splice(e,1)},t.prototype.Update=function(){for(var t in this.m_EntityArray)this.m_EntityArray[t].OnUpdate()},t}(),Scene=function(){function t(){this.m_RequestSequence=0,this.m_Sequence=0,this.m_SequenceCnt=0,this.m_SequenceFlag=[0,0,0]}return t.prototype.ChangeSequence=function(t){this.m_RequestSequence=t},t.prototype.Init=function(){this.OnInit()},t.prototype.Update=function(t){this.OnUpdate(),this.m_RequestSequence!=this.m_Sequence?(this.m_Sequence=this.m_RequestSequence,this.m_SequenceCnt=0,this.m_SequenceFlag=[0,0,0]):this.m_SequenceCnt+=t},t.prototype.EndScene=function(){this.OnTerm()},t}();